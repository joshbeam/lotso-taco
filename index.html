<!doctype html>
<html>
	<head>
	    <script src="https://fb.me/react-0.13.3.js"></script>
	    <script src="https://fb.me/JSXTransformer-0.13.3.js"></script>
	    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.2/marked.min.js"></script>

	    <link rel="stylesheet" href="styles/styles.css">
	</head>
	<body>
		<div id="slider"></div>
		<script type="text/jsx">
			var images = [
				'images/happy-taco.gif',
				'images/lots-of-tacos.png',
				'images/soft-taco.png',
				'images/taco.jpg',
				'images/two-tacos.jpg'
			];

			//// COMPONENTS

			var Slider = React.createClass({
				getInitialState: function() {
					return {
						showing: 0
					};
				},
				changeImage: function(to) {
					console.log(to);
					var limit = images.length - 1;

					if(to === -1) {
						if(this.state.showing === 0) {
							this.setState({showing: limit});
						} else {
							this.setState({showing: this.state.showing - 1});
						}
					} else if(to === 1) {
						if(this.state.showing === limit) {
							this.setState({showing: 0});
						} else {
							this.setState({showing: this.state.showing + 1});
						}
					}
				},
				render: function() {
					return (
						<div className="slider">
							<h1>{this.props.title}</h1>
							<Pane images={this.props.images} showing={this.state.showing} />
							<Controls onImageChange={this.changeImage} />
						</div>
					);
				}
			});

			var Pane = React.createClass({
				render: function() {
					return (
						<div className="pane">
							{this.props.images.map(function(url, i) {
								return <img src={url} key={i} className={ this.props.showing === i ? '' : 'hidden' } />;
							}.bind(this))}
						</div>
					);
				}
			});

			var Controls = React.createClass({
				changeImage: function(to) {
					this.props.onImageChange(to);
				},
				render: function() {
					return (
						<div className="controls">
							<Control to={-1} changeImage={this.changeImage} />
							<Control to={1} changeImage={this.changeImage} />
						</div>
					);
				}
			});

			var Control = React.createClass({
				onClick: function() {
					this.props.changeImage(this.props.to);
				},
				render: function() {
					return (
						<button className="control" onClick={this.onClick}>{this.props.to === -1 ? 'Previous' : 'Next'}</button>
					);
				}
			});

			React.render(<Slider title="Lotso Taco" images={images} />, document.getElementById('slider'));
		</script>
	</body>
</html>